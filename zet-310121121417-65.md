---
created: 2021-01-31 12:14
title: redis
tags: :Tech:Application:redis:
Backlinks: [index](index.md)
type: text/x-markdown
---

## 备份

### RDB(快照)

Redis Database Backup

- 配置: save [seconds] [changes]

### AOF

Append Only File
类似mysql binlog

- 配置开关: appendonly yes

- fsync配置：  appendfsync
  
  - no: 交给os处理
  - always： 每条日志操作
  - everysec: 折中做法，每秒进行一次

- AOF rewrite

## 内存管理

做缓存时可以手动定期删除key或者设置`maxmemory`&`maxmemory-policy`。

### maxmemory

### 淘汰策略:maxmemory-policy

- volatile-lru
  设置有效期的key lru

- allkeys-lru
  所有key-lru

- volatile-random
  随机淘汰，只淘汰设置有有效期的key

- allkeys-random
  随机淘汰数据

- volatile-ttl
  淘汰剩余有效期最短的

## 事物/scripting

## pipeline

连续且无相关的命令

## Distribute

1. master-slave replication
   通过`SYNC`命令同步master内容到slave。
2. sentinel
   监控节点运行状态，主从切换。
3. redis-cluster
   去中心化，使用gossip在集群间同步路由表和集群拓补信息,每个节点都保存相关信息。
   *客户端向任一节点发送请求，根据节点返回值做重定向(MOVE、ASK)操作*
4. codis
   请求先请求到proxy,proxy做sharing后转发到相应实例上。`sharding规则`(路由表/转发表/slot表)保存在集中化组建(zookeeper, 文件系统等).
   *codis在redis源码patch slot代码实现slot功能。*

## Aritileces

* [Redis基础常用类型、时间复杂度](https://app.getpocket.com/read/2402341457)
* [redis 内部结构-源码解析](http://zhangtielei.com/posts/blog-redis-dict.html)
* [redis mind map图](210203-1808.md)
* [redis 集群介绍pdf](file:../articles/Tech/redis-cluster和Codis关于slot迁移原理对比 - 黑客画家的个人空间 - OSCHINA __ Reader View.pdf)

